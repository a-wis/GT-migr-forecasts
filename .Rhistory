theme(legend.position = "right")
# pq2=
Q1 %>%
filter(domain!="other", Or!="Other", Or!="Within the same region") %>%
ggplot() +
geom_bar(aes(x=cat,y=value,fill=domain), size=0.5, stat = "identity") +
# coord_polar() +
# coord_radar() +
facet_grid(Or~Dest,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "free_y") +
theme_bw() +
labs(y="count of votes",x="") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "right")
# pq2=
Q1 %>%
filter(domain!="other", Or!="Other", Or!="Within the same region") %>%
ggplot() +
geom_bar(aes(x=cat,y=10^value,fill=domain), size=0.5, stat = "identity") +
# coord_polar() +
# coord_radar() +
facet_grid(Or~Dest,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "free_y") +
theme_bw() +
labs(y="count of votes",x="") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "right")
# pq2=
Q1 %>%
filter(domain!="other", Or!="Other", Or!="Within the same region") %>%
ggplot() +
geom_bar(aes(x=cat,y=2^value,fill=domain), size=0.5, stat = "identity") +
# coord_polar() +
# coord_radar() +
facet_grid(Or~Dest,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "free_y") +
theme_bw() +
labs(y="count of votes",x="") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "right")
Q1 %>% group_by(corridor) %>% top_n(value,3)
Q1 %>% group_by(corridor) %>% top_n(value,3) %>% View
Q1 %>% group_by(corridor) %>% top_n(value,4) %>% View
Q1 %>% group_by(corridor) %>% top_n(value,3) %>% View
Q1 %>% group_by(corridor) %>% summarise(top_n(value,3)) %>% View
Q1 %>% group_by(corridor) %>% top_n(value,2) %>% View
Q1 %>% group_by(corridor) %>% top_n(value,1) %>% View
Q1 %>% group_by(corridor) %>% top_n(value,5) %>% View
?top_n
Q1 %>% group_by(corridor) %>% slice_max(value,n=5) %>% View
Q1 %>% group_by(corridor) %>% slice_max(value,n=3) %>% View
Q1 %>% filter(corridor=="Asia.Eastern EU")
Q1 %>% filter(corridor=="Asia.Eastern EU") %>% View
Q1 %>% group_by(corridor) %>% slice_max(value,n=3) %>% View
Q1 %>% group_by(corridor) %>% slice_max(value,n=2) %>% View
pq2
pq1
View(pq1)
# pq2=
Q1 %>%
filter(domain!="other", Or!="Other", Or!="Within the same region") %>%
ggplot() +
geom_bar(aes(x=cat,y=valstd,fill=domain), size=0.5, stat = "identity") +
# coord_polar() +
# coord_radar() +
facet_grid(Or~Dest,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "free_y") +
theme_bw() +
labs(y="count of votes",x="") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "right")
# pq2=
Q1 %>%
filter(domain!="other", Or!="Other", Or!="Within the same region") %>%
ggplot() +
geom_bar(aes(x=cat,y=valstd,fill=domain), size=0.5, stat = "identity") +
coord_polar() +
# coord_radar() +
facet_grid(Or~Dest,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "free_y") +
theme_bw() +
labs(y="count of votes",x="") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "right")
# pq2=
Q1 %>%
filter(domain!="other", Or!="Other", Or!="Within the same region") %>%
ggplot() +
geom_bar(aes(x=cat,y=valstd,fill=domain), size=0.5, stat = "identity") +
coord_polar() +
# coord_radar() +
facet_grid(Or~Dest,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "fixed") +
theme_bw() +
labs(y="count of votes",x="") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "right")
# pq2=
Q1 %>%
filter(domain!="other", Or!="Other", Or!="Northern America") %>%
ggplot() +
geom_bar(aes(x=cat,y=valstd,fill=domain), size=0.5, stat = "identity") +
coord_polar() +
# coord_radar() +
facet_grid(Or~Dest,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "fixed") +
theme_bw() +
labs(y="count of votes",x="") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "right")
# pq2=
Q1 %>%
filter(domain!="other", Or!="Other", Or!="Northern America") %>%
ggplot() +
geom_bar(aes(x=cat,y=valstd,fill=domain), size=0.5, stat = "identity") +
# coord_polar() +
# coord_radar() +
facet_grid(Or~Dest,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "fixed") +
theme_bw() +
labs(y="count of votes",x="") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "right")
Q1 %>%
filter(domain!="other", Or!="Other") %>%
group_by(cat,domain) %>%
summarise(total=sum(value)) %>%
ungroup() %>%
ggplot() +
geom_bar(aes(x=cat,y=total,fill=domain), size=0.5, stat = "identity") +
# coord_polar() +
# coord_radar() +
# facet_wrap(cat~.,nrow = 2,
# labeller = label_wrap_gen(width = 15,multi_line = T),
# switch = "y") +
theme_bw() +
labs(y="count of votes",x="driver of migration") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "right")
pq3=Q1 %>%
filter(domain!="other", Or!="Other") %>%
group_by(cat,Or,domain) %>%
summarise(total=sum(value)) %>%
ungroup() %>%
ggplot() +
geom_bar(aes(x=cat,y=total,fill=domain), size=0.5, stat = "identity") +
# coord_polar() +
# coord_radar() +
facet_grid(Or~.,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "fixed") +
theme_bw() +
labs(y="count of votes",x="driver of migration") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "right")
pq3
Q1 %>%
filter(domain!="other", Or!="Other") %>%
group_by(cat,Or,domain) %>%
summarise(total=sum(value)) %>%
ungroup() %>%
ggplot() +
geom_bar(aes(x=cat,y=total,fill=domain), size=0.5, stat = "identity") +
coord_polar() +
# coord_radar() +
facet_grid(.~Or,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "fixed") +
theme_bw() +
labs(y="count of votes",x="driver of migration") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "right")
Q1 %>%
filter(domain!="other", Or!="Other") %>%
group_by(cat,Or,domain) %>%
summarise(total=sum(value)) %>%
ungroup() %>%
ggplot() +
geom_bar(aes(x=cat,y=total,fill=domain), size=0.5, stat = "identity") +
coord_polar() +
# coord_radar() +
facet_grid(.~Or,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "fixed") +
theme_bw() +
labs(y="count of votes",x="driver of migration") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "none")
Q1 %>%
filter(domain!="other", Or!="Other") %>%
group_by(cat,Or,domain) %>%
summarise(total=sum(valstd)) %>%
ungroup() %>%
ggplot() +
geom_bar(aes(x=cat,y=total,fill=domain), size=0.5, stat = "identity") +
coord_polar() +
# coord_radar() +
facet_grid(.~Or,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "fixed") +
theme_bw() +
labs(y="count of votes",x="driver of migration") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "none")
Q1 %>%
filter(domain!="other", Or!="Other",Or!="Northern America") %>%
group_by(cat,Or,domain) %>%
summarise(total=sum(valstd)) %>%
ungroup() %>%
ggplot() +
geom_bar(aes(x=cat,y=total,fill=domain), size=0.5, stat = "identity") +
coord_polar() +
# coord_radar() +
facet_grid(.~Or,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "fixed") +
theme_bw() +
labs(y="count of votes",x="driver of migration") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "none")
Q1 %>%
filter(domain!="other", Or!="Other",Or!="Northern America") %>%
group_by(cat,Or,domain) %>%
summarise(total=sum(value)) %>%
ungroup() %>%
ggplot() +
geom_bar(aes(x=cat,y=total,fill=domain), size=0.5, stat = "identity") +
coord_polar() +
# coord_radar() +
facet_grid(.~Or,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "fixed") +
theme_bw() +
labs(y="count of votes",x="driver of migration") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "none")
Q1 %>%
filter(domain!="other", Or!="Other") %>%
group_by(cat,Or,domain) %>%
summarise(total=sum(value)) %>%
ungroup()
Q1aux= Q1 %>%
filter(domain!="other", Or!="Other") %>%
group_by(cat,Or,domain) %>%
summarise(total=sum(value)) %>%
ungroup()
Q1aux %>% group_by(Or) %>%
summarise(tot_count=sum(total)) %>%
ungroup() %>%
right_join(Q1aux) %>%
mutate(totstd = total/tot_count) %>%
ggplot() +
geom_bar(aes(x=cat,y=totstd,fill=domain), size=0.5, stat = "identity") +
coord_polar() +
# coord_radar() +
facet_grid(.~Or,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "fixed") +
theme_bw() +
labs(y="count of votes",x="driver of migration") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "none")
Q1aux %>% group_by(Or) %>%
summarise(tot_count=sum(total)) %>%
ungroup() %>%
right_join(Q1aux) %>%
mutate(totstd = total/tot_count) %>%
ggplot() +
geom_bar(aes(x=cat,y=totstd,fill=domain), size=0.5, stat = "identity") +
# coord_polar() +
# coord_radar() +
facet_grid(.~Or,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "fixed") +
theme_bw() +
labs(y="count of votes",x="driver of migration") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "none")
Q1aux %>% group_by(Or) %>%
summarise(tot_count=sum(total)) %>%
ungroup() %>%
right_join(Q1aux) %>%
mutate(totstd = total/tot_count) %>%
ggplot() +
geom_bar(aes(x=cat,y=total,fill=domain), size=0.5, stat = "identity") +
coord_polar() +
# coord_radar() +
facet_grid(.~Or,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "fixed") +
theme_bw() +
labs(y="count of votes",x="driver of migration") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "none")
Q1aux= Q1 %>%
filter(domain!="other", Or!="Other") %>%
group_by(cat,Dest,domain) %>%
summarise(total=sum(value)) %>%
ungroup()
Q1aux %>% group_by(Dest) %>%
summarise(tot_count=sum(total)) %>%
ungroup() %>%
right_join(Q1aux) %>%
mutate(totstd = total/tot_count) %>%
ggplot() +
geom_bar(aes(x=cat,y=total,fill=domain), size=0.5, stat = "identity") +
coord_polar() +
# coord_radar() +
facet_grid(.~Dest,
labeller = label_wrap_gen(width = 15,multi_line = T),
switch = "y", scales = "fixed") +
theme_bw() +
labs(y="count of votes",x="driver of migration") +
# labs(y="count of votes",x="driver/motivation") +
theme(legend.position = "none")
exp(-0.62)
exp(0.62)
1/exp(0.62)
1/exp(-0.62)
exp(10)
x
x=rlnorm(100000,1,0.05)
median(x)
sd(x)
sd(x)/median(x)
sd(x)/mean(x)
x=rlnorm(10000000,1,0.05)
sd(x)/mean(x)
sd(x)/median(x)
quantile(x,c(0.025,0.5,0.975))
quantile(x,c(0.025,0.5,0.975))[3]/median(x)
quantile(x,c(0.025,0.5,0.975))[3]/mean(x)
quantile(x,c(0.025,0.5,0.975))[1]/mean(x)
quantile(x,c(0.025,0.5,0.975))[1]/median(x)
x=rlnorm(10000000,1,0.2)
quantile(x,c(0.025,0.5,0.975))[1]/median(x)
quantile(x,c(0.025,0.5,0.975))[3]/median(x)
x=rlnorm(10000000,1,0.15)
quantile(x,c(0.025,0.5,0.975))[3]/median(x)
quantile(x,c(0.025,0.5,0.975))[1]/median(x)
qnorm(0.025)
exp(1)*(0.15)^qnorm(0.025)
exp(1+0.15*qnorm(0.025))
quantile(x,c(0.025,0.5,0.975))[1]
quantile(x,c(0.025,0.5,0.975))
exp(1+0.15*qnorm(0.975))
qnorm(0.025)
qnorm(0.975)
qnorm(0.5)
exp(0.05)
sqrt(exp(0.05)-1)
sqrt(exp(0.05^2)-1)
sqrt(exp(0.1^2)-1)
sqrt(exp(0.5^2)-1)
sqrt(exp(0.01^2)-1)
1/5000
1/1000
1/2000
1/5000^2
1/5000^.5
1/1111^.5
1/50^.5
mtcars
mod=lm(mpg~cyl,data=mtcars)
mod$residuals
View(mod$residuals)
View(mod$df.residual)
mod=lm(mpg~gear,data=mtcars)
mod
mod=lm(mpg~factor(gear),data=mtcars)
mod
load("C:/Users/msassaw5/Dropbox (The University of Manchester)/Research/Modelling Bikes - Manchester 2020/Code/R Code/LSOA/GreaterManchester_LSOA.Rda")
library(tidyverse)
library(viridis)
library(ggspatial)
library(classInt)
library(sf)
#library(osmdata)
library(ggmap)
library(concaveman)
library(osmdata)
library(osmar)
library(spdep)
library(dbscan)
library(spdep)
library(rgeos)
gm_lsoa %>% count(LSA11CD)
gm_lsoa %>% count(LSOA11CD)
load("C:/Users/msassaw5/Dropbox (The University of Manchester)/Research/Modelling Bikes - Manchester 2020/Data/all_data_001.RData")
gm_lsoa %>% table(LSOA11CD)
gm_lsoa %>% count(LSOA11CD)
gm_lsoa %>% as.data.frame() %>% count(LSOA11CD)
joined_data_all %>% summary(accident_index)
joined_data_all %>% count(accident_index)
View(joined_data_all)
View(joined_data_all$x)
View(joined_data_all$geometry.x)
View(joined_data_all$geometry.y)
names(joined_data_all)
joined_data_all %>% group_by(voronoi_id) %>% count(accident_index)
joined_data_all %>% as.data.frame() %>% group_by(voronoi_id) %>% count(accident_index)
joined_data_all %>% as.data.frame() %>% group_by(voronoi_id) %>% sum(accident_index)
joined_data_all %>% as.data.frame() %>% group_by(voronoi_id) %>% tally(accident_index)
joined_data_all %>% mutate(accident_bin=ifelse(is.na(acc_id)==T,0,1))
joined_data_all %>% as.data.frame() %>% group_by(voronoi_id) %>% tally(accident_bin)
joined_data_all %>% as.data.frame() %>% group_by(voronoi_id) %>% count(accident_bin)
joined_data_all=joined_data_all %>% mutate(accident_bin=ifelse(is.na(acc_id)==T,0,1))
joined_data_all %>% as.data.frame() %>% group_by(voronoi_id) %>% count(accident_bin)
temp=joined_data_all %>% as.data.frame() %>% group_by(voronoi_id) %>% count(accident_bin)
View(temp)
joined_data_all=joined_data_all %>% mutate(accident_bin=ifelse(is.na(acc_id)==T,NA,1))
temp=joined_data_all %>% as.data.frame() %>% group_by(voronoi_id) %>% count(accident_bin)
temp=joined_data_all %>% as.data.frame() %>% group_by(voronoi_id) %>% sum(accident_bin)
temp=joined_data_all %>% as.data.frame() %>% group_by(voronoi_id) %>% summarise(sum(accident_bin))
joined_data_all=joined_data_all %>% mutate(accident_bin=ifelse(is.na(acc_id)==T,0,1))
temp=joined_data_all %>% as.data.frame() %>% group_by(voronoi_id) %>% summarise(sum(accident_bin))
temp=joined_data_all %>% as.data.frame() %>% group_by(voronoi_id) %>% summarise(acc_no=sum(accident_bin))
joined_data_all = joined_data_all %>% left_join(temp)
library(rstanarm)
?pp_check
1/2
1/35
library(rcompendium)
?rcompendium
?new_package
?add_readme_rmd
add_readme_rmd()
library(rcompendium)
exp(0.042)
exp(0.071)
exp(0.055)
setwd("C:/Users/msassaw5/Dropbox (The University of Manchester)/GitHub/GT-migr-forecasts")
x=rnorm(10000, 0, sd=0.5)
m.kr=rnorm(10000, 0, sd=0.5)
?rgamma
t.kr=rgamma(10000,shape = 5,rate=1)
x=rnorm(10000, mean = m.kr, sd=1/sqrt(t.kr))
plot(x)
hist(x)
hist(1+exp(-x))
hist(1+exp(-x),100)
hist(1/(1+exp(-x)),100)
hist(1/(1+exp(-x)),100)
t.kr=rgamma(10000,shape = 9,rate=1)
x=rnorm(10000, mean = m.kr, sd=1/sqrt(t.kr))
hist(1/(1+exp(-x)),100)
hist(1/(1+exp(-x)),100,xlim=c(0,1))
t.kr=rgamma(10000,shape = 5,rate=1)
x=rnorm(10000, mean = m.kr, sd=1/sqrt(t.kr))
hist(1/(1+exp(-x)),100,xlim=c(0,1))
m.kr=rnorm(10000, 0, sd=1)
x=rnorm(10000, mean = m.kr, sd=1/sqrt(t.kr))
hist(1/(1+exp(-x)),100,xlim=c(0,1))
m.kr=rnorm(10000, 0, sd=sqrt(1/3))
x=rnorm(10000, mean = m.kr, sd=1/sqrt(t.kr))
hist(1/(1+exp(-x)),100,xlim=c(0,1))
t.kr=rgamma(10000,shape = 9,rate=1)
x=rnorm(10000, mean = m.kr, sd=1/sqrt(t.kr))
hist(1/(1+exp(-x)),100,xlim=c(0,1))
m.kr=rnorm(10000, 0, sd=sqrt(1/1))
x=rnorm(10000, mean = m.kr, sd=1/sqrt(t.kr))
hist(1/(1+exp(-x)),100,xlim=c(0,1))
t.kr=rgamma(10000,shape = 5,rate=1)
x=rnorm(10000, mean = m.kr, sd=1/sqrt(t.kr))
hist(1/(1+exp(-x)),100,xlim=c(0,1))
t.kr=rgamma(10000,shape = 9,rate=1)
x=rnorm(10000, mean = m.kr, sd=1/sqrt(t.kr))
hist(1/(1+exp(-x)),100,xlim=c(0,1))
m.kr=rnorm(10000, 0, sd=sqrt(1/1))
t.kr=rgamma(10000,shape = 9,rate=1)
x=rnorm(10000, mean = m.kr, sd=1/sqrt(t.kr))
hist(1/(1+exp(-x)),100,xlim=c(0,1))
m.kr=rnorm(10000, 0, sd=sqrt(1/2))
t.kr=rgamma(10000,shape = 9,rate=1)
x=rnorm(10000, mean = m.kr, sd=1/sqrt(t.kr))
hist(1/(1+exp(-x)),100,xlim=c(0,1))
x1=rnorm(10000, mean = 0, sd=1/sqrt(t.kr))
hist(1/(1+exp(-x1)),100,xlim=c(0,1))
t.kr=rgamma(10000,shape = 5,rate=1)
x1=rnorm(10000, mean = 0, sd=1/sqrt(t.kr))
hist(1/(1+exp(-x1)),100,xlim=c(0,1))
m.kr=rnorm(10000, 0, sd=sqrt(1/4))
t.kr=rgamma(10000,shape = 9,rate=1)
x=rnorm(10000, mean = m.kr, sd=1/sqrt(t.kr))
hist(1/(1+exp(-x)),100,xlim=c(0,1))
library(BMA)
?bicreg
library(MASS)
data(UScrime)
x<- UScrime[,-16]
y<- log(UScrime[,16])
x[,-2]<- log(x[,-2])
lma<- bicreg(x, y, strict = FALSE, OR = 20)
summary(lma)
plot(lma)
?lm
?model.matrix
?BMA::predict.bicreg
crimeBMA <- bicreg(x, y, strict = FALSE, OR = 20)
predict( crimeBMA, x)
View(crimeBMA)
View(crimeBMA)
View(x)
str(x)
